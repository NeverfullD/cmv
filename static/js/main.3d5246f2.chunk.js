(this.webpackJsonpcmv=this.webpackJsonpcmv||[]).push([[0],{45:function(e,t,n){},48:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){},74:function(e,t,n){},76:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),i=n(28),r=n.n(i),o=(n(45),n(5)),u=n(6),c=n(7),l=n(8),h=n(31),p=(n(48),n(2)),m=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(e){var a;Object(o.a)(this,n);var s=(a=t.call(this,e)).generateData();return a.state={data:s},a}return Object(u.a)(n,[{key:"generateData",value:function(){var e=this,t=[],n=["x"];this.props.model.compartments.forEach((function(e){return n.push(e.name)})),t.push(n);for(var a=function(n){i=[e.props.timeSteps[n]],e.props.model.compartments.forEach((function(e){return i.push(e.value[n])})),t.push(i)},s=0;s<=this.props.currentTick;s++){var i;a(s)}return t}},{key:"componentDidMount",value:function(){}},{key:"onClick",value:function(){}},{key:"render",value:function(){return Object(p.jsxs)("div",{className:"chart",children:["Chart",Object(p.jsx)(h.a,{width:"600px",height:"400px",chartType:"LineChart",loader:Object(p.jsx)("div",{children:"Loading Chart"}),data:this.state.data,options:{hAxis:{title:"Time"},vAxis:{title:"Value"}},rootProps:{"data-testid":"2"}})]})}}]),n}(s.a.Component),v=n(38),d=(n(61),function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(e){var a;Object(o.a)(this,n);var s=(a=t.call(this,e)).generateInitialDataStructure();return a.state={data:s},a}return Object(u.a)(n,[{key:"generateInitialDataStructure",value:function(){var e=[];this.props.model.compartments.forEach((function(t){e.push({id:t.name,size:t.value[t.value.length-1]})}));return{nodes:e,links:[]}}},{key:"componentDidMount",value:function(){}},{key:"onClick",value:function(){}},{key:"render",value:function(){return Object(p.jsxs)("div",{className:"graph",children:["Graph",Object(p.jsx)(v.a,{graphData:this.state.data,nodeLabel:"id",nodeVal:function(e){return e.size},width:500,height:500})]})}}]),n}(s.a.Component)),f=(n(62),n(37)),j=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={value:"(param alpha 0.75)\n(param beta 0.1)\n(param N 10000)\n\n(comp S 9999 {-alpha*S*I/N})\n(comp I 1 {alpha*S*I/N - beta*I})\n(comp R 0 {beta*I})",parser:Object(f.generate)('{{\nfunction makeFloat(o) {\n    return parseFloat(o.join(""), 10);\n}\n}}\n\nmodel = parameters:parameter* _ compartments:compartment+ {return {parameters, compartments};}\ncompartment = "(" _ "comp" _ name:ident _ value:value _ ODE:calc _ ")" _ {return {name, value:[value], ODE};}\nparameter = "(" _ "param" _ name:ident _ value:value _ ")" _ {return {name, value};}\nident = ident:[A-Za-z]+ {return ident.join("")}\nvalue = digits:[0-9.]+ {return makeFloat(digits);}\n_ "whitespace" = [ \\t\\n\\r]*\ncalc = "{" calc:[^}]* "}" {return calc.join("")}')},a}return Object(u.a)(n,[{key:"onClick",value:function(e){this.props.setNewModel(this.state.parser.parse(this.state.value)),e.preventDefault()}},{key:"handleChange",value:function(e){this.setState({value:e.target.value})}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return Object(p.jsxs)("div",{className:"parser",children:["Parser",Object(p.jsxs)("form",{onSubmit:this.onClick.bind(this),children:[Object(p.jsxs)("label",{children:["Model:",Object(p.jsx)("br",{}),Object(p.jsx)("textarea",{className:"parserText",value:this.state.value,onChange:this.handleChange.bind(this)})]}),Object(p.jsx)("br",{}),Object(p.jsx)("input",{type:"submit",value:"Submit"})]})]})}}]),n}(s.a.Component),S=(n(74),function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).onSimulate1=function(){a.props.onSimulate(1)},a.onSimulate10=function(){a.props.onSimulate(10)},a.onSimulate100=function(){a.props.onSimulate(100)},a.onSimulate1000=function(){a.props.onSimulate(1e3)},a.onSimulate=function(){a.props.onSimulate(parseInt(a.state.steps))},a.onChangeStepSize=function(){a.props.changeStepSize(parseFloat(a.state.stepSize))},a.handleChangeSteps=function(e){a.setState({steps:e.target.value})},a.handleChangeStepSize=function(e){a.setState({stepSize:e.target.value})},a.state={steps:"",stepSize:""},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return Object(p.jsxs)("div",{className:"settings",children:["Settings",Object(p.jsx)("br",{}),Object(p.jsx)("button",{onClick:this.onSimulate1,children:"Simulate 1"}),Object(p.jsx)("button",{onClick:this.onSimulate10,children:"Simulate 10"}),Object(p.jsx)("button",{onClick:this.onSimulate100,children:"Simulate 100"}),Object(p.jsx)("button",{onClick:this.onSimulate1000,children:"Simulate 1000"}),Object(p.jsx)("button",{onClick:this.onSimulate,children:"Simulate: "}),Object(p.jsx)("input",{type:"text",value:this.state.steps,onChange:this.handleChangeSteps}),Object(p.jsx)("br",{}),Object(p.jsxs)("button",{onClick:this.onChangeStepSize,children:["Change Step Size (currently: ",this.props.stepSize,"): "]}),Object(p.jsx)("input",{type:"text",value:this.state.stepSize,onChange:this.handleChangeStepSize})]})}}]),n}(s.a.Component)),b=n(75).Parser,g=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).setModel=function(e){a.setState({model:e,currentTick:0,timeSteps:[0]})},a.onClick=function(){console.log(a.state.model)},a.onSimulate=function(e){a.solveSteps(e)},a.changeStepSize=function(e){a.setState({stepSize:e})},a.state={model:{parameters:[],compartments:[]},stepSize:.1,currentTick:0,timeSteps:[]},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){}},{key:"rungeKutta2",value:function(e){var t=this,n=new Map(e);this.state.model.compartments.forEach((function(a){var s=t.evaluateExpression(a.ODE,e)*(t.state.stepSize/2);n.set(a.name,a.value[a.value.length-1]+s)})),this.state.model.compartments.forEach((function(e){var a=t.evaluateExpression(e.ODE,n)*t.state.stepSize;e.value.push(e.value[e.value.length-1]+a)}))}},{key:"rungeKutta4",value:function(e){var t=this,n=new Map(e),a=new Map;this.state.model.compartments.forEach((function(s){var i=t.evaluateExpression(s.ODE,e)*t.state.stepSize;n.set(s.name,s.value[s.value.length-1]+i/2),a.set(s.name,[i])})),this.state.model.compartments.forEach((function(e){var s=t.evaluateExpression(e.ODE,n)*t.state.stepSize;n.set(e.name,e.value[e.value.length-1]+s/2),a.get(e.name).push(s)})),this.state.model.compartments.forEach((function(e){var s=t.evaluateExpression(e.ODE,n)*t.state.stepSize;n.set(e.name,e.value[e.value.length-1]+s),a.get(e.name).push(s)})),this.state.model.compartments.forEach((function(e){var s=t.evaluateExpression(e.ODE,n)*t.state.stepSize;a.get(e.name).push(s)})),this.state.model.compartments.forEach((function(e){e.value.push(e.value[e.value.length-1]+1/6*a.get(e.name)[0]+2/6*a.get(e.name)[1]+2/6*a.get(e.name)[2]+1/6*a.get(e.name)[3])}))}},{key:"euler",value:function(e){var t=this;this.state.model.compartments.forEach((function(n){var a=t.evaluateExpression(n.ODE,e)*t.state.stepSize;n.value.push(n.value[n.value.length-1]+a)}))}},{key:"modifiedMidpointMethod",value:function(e,t){var n=this,a=this.state.stepSize/t,s=new Map(e),i=new Map,r=new Map;this.state.model.compartments.forEach((function(e){var t=n.evaluateExpression(e.ODE,s),r=e.value[e.value.length-1]+a*t;s.set(e.name,r),i.set(e.name,[e.value[e.value.length-1],r])}));for(var o=function(e){n.state.model.compartments.forEach((function(t){var r=n.evaluateExpression(t.ODE,s),o=i.get(t.name)[e-1]+2*a*r;s.set(t.name,o),i.get(t.name).push(o)}))},u=1;u<t;u++)o(u);return this.state.model.compartments.forEach((function(e){var o=n.evaluateExpression(e.ODE,s),u=.5*(i.get(e.name)[t]+i.get(e.name)[t-1]+a*o);r.set(e.name,u)})),r}},{key:"bulirschStoerMethod",value:function(e){for(var t=this,n=[],a=function(a){n[a]=[];for(var s=function(s){0===s?n[a][s]=t.modifiedMidpointMethod(e,2*(a+1)):(i=new Map,t.state.model.compartments.forEach((function(e){var t=n[a][s-1].get(e.name)+(n[a][s-1].get(e.name)-n[a-1][s-1].get(e.name))/(Math.pow(a/(a-1),2*s)-1);i.set(e.name,t)})),n[a][s]=i)},r=0;r<=a;r++)s(r)},s=0;s<4;s++){var i;a(s)}return n[n.length-1][n[n.length-1].length-1]}},{key:"applyResult",value:function(e){this.state.model.compartments.forEach((function(t){t.value.push(e.get(t.name))}))}},{key:"solveSteps",value:function(e){for(var t=this,n=function(e){s=new Map,t.state.model.compartments.forEach((function(n){return s.set(n.name,n.value[t.state.currentTick+e])})),t.state.model.parameters.forEach((function(e){return s.set(e.name,e.value)})),t.applyResult(t.bulirschStoerMethod(s)),t.state.timeSteps.push(t.state.timeSteps[t.state.currentTick+e]+t.state.stepSize)},a=0;a<e;a++){var s;n(a)}this.setState({currentTick:this.state.currentTick+e})}},{key:"evaluateExpression",value:function(e,t){return b.evaluate(e,Object.fromEntries(t))}},{key:"render",value:function(){return Object(p.jsxs)("div",{children:["Test",Object(p.jsx)("button",{onClick:this.onClick,children:"Test"}),Object(p.jsx)("a",{href:"https://github.com/NeverfullD/cmv",children:"to Github"}),Object(p.jsx)(j,{setNewModel:this.setModel}),Object(p.jsx)(S,{onSimulate:this.onSimulate,changeStepSize:this.changeStepSize,stepSize:this.state.stepSize}),Object(p.jsx)(m,{model:this.state.model,timeSteps:this.state.timeSteps,currentTick:this.state.currentTick},this.state.currentTick+"chart"),Object(p.jsx)(d,{model:this.state.model},this.state.currentTick+"graph")]})}}]),n}(s.a.Component),O=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,85)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),a(e),s(e),i(e),r(e)}))};r.a.render(Object(p.jsx)(s.a.StrictMode,{children:Object(p.jsx)(g,{})}),document.getElementById("root")),O()}},[[76,1,2]]]);
//# sourceMappingURL=main.3d5246f2.chunk.js.map